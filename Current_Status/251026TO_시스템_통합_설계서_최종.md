# 📋 TO 시스템 통합 설계서 (단기 + 장기 채용)

**작성일**: 2025년 10월 27일  
**문서 버전**: v4.0 (통합본)  
**작성자**: 개발팀  

---

## 📌 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [완료된 작업 (Phase 1)](#2-완료된-작업-phase-1)
3. [추가 논의 사항](#3-추가-논의-사항)
4. [단기 TO 시스템 (현재)](#4-단기-to-시스템-현재)
5. [장기 채용 시스템 (신규)](#5-장기-채용-시스템-신규)
6. [구현 우선순위](#6-구현-우선순위)
7. [데이터베이스 구조](#7-데이터베이스-구조)
8. [화면 설계](#8-화면-설계)
9. [개발 로드맵](#9-개발-로드맵)

---

## 1. 프로젝트 개요

### 1.1 시스템 목적
물류센터 및 사업장의 **단기/장기 근무자 통합 관리** 시스템

### 1.2 핵심 기능
```
📦 단기 TO (1~30일)
├─ 날짜별 개별 지원 가능
├─ 날짜 범위 일괄 등록
├─ 시급/일급 중심
└─ 즉시 확정 프로세스

💼 장기 채용 (1개월 이상)
├─ 전체 기간 필수 근무
├─ 월급 중심
├─ 면접 → 근태 관리
└─ 계약/급여 시스템
```

---

## 2. 완료된 작업 (Phase 1)

### 2.1 TO 모델 그룹화 ✅

#### 추가된 필드
```dart
class TOModel {
  // 그룹 관련
  final String? groupId;        // 그룹 ID
  final String? groupName;      // 그룹 이름
  final DateTime? startDate;    // 그룹 시작일
  final DateTime? endDate;      // 그룹 종료일
  final bool isGroupMaster;     // 대표 TO (목록 표시용)
  
  // Getter
  bool get isGroupTO => groupId != null;
  String? get groupPeriodString => "10/25~10/27";
  int? get groupDaysCount => 3;
}
```

#### Firestore 구조
```
tos/
├─ to_id_1 (대표)
│  ├─ groupId: "group_xxx"
│  ├─ isGroupMaster: true
│  ├─ startDate: 2025-10-25
│  ├─ endDate: 2025-10-27
│  └─ date: 2025-10-25
│
├─ to_id_2
│  ├─ groupId: "group_xxx"
│  ├─ isGroupMaster: false
│  └─ date: 2025-10-26
│
└─ to_id_3
   ├─ groupId: "group_xxx"
   └─ date: 2025-10-27
```

---

### 2.2 날짜 범위 TO 생성 ✅

#### 생성 화면
```
┌─────────────────────────────┐
│ 📅 근무 날짜                 │
│ ┌───────────┬───────────┐   │
│ │ 단일 날짜 │ 날짜 범위 │   │
│ └───────────┴───────────┘   │
└─────────────────────────────┘
```

**단일 모드**: 1개 TO 생성  
**범위 모드**: 시작일~종료일 모든 날짜 자동 생성

#### 검증 로직
```dart
// 1. 최대 30일 제한
if (daysDiff > 30) {
  ToastHelper.showWarning('최대 30일까지만 선택 가능');
}

// 2. 마감시간은 종료일 당일까지 OK
if (deadlineDateOnly.isAfter(endDateOnly)) {
  ToastHelper.showWarning('마감 시간은 종료일 이전 또는 당일');
}
```

#### 실시간 피드백
```
시작일: 10/25
종료일: 10/27
→ 💡 총 3일간의 TO가 생성됩니다

종료일: 11/30 (68일)
→ ⚠️ 최대 30일까지만 선택 가능 (현재 68일)
```

---

### 2.3 TO 목록 화면 ✅

#### 그룹 표시
```
┌─────────────────────────────┐
│ 테스트1 물류센터             │
│ 테스트 그룹TO                │
│                             │
│ 📅 10/25~10/27 (3일)        │
│ ⏰ 09:00 ~ 18:00            │
│ 👥 확정: 0/1  ⏳ 대기: 0   │
└─────────────────────────────┘
```

#### 조회 로직
```dart
// 대표 TO만 조회
Future<List<TOModel>> getGroupMasterTOs() async {
  // isGroupMaster == true OR groupId == null
}
```

---

### 2.4 완료된 파일 목록
```
✅ lib/models/to_model.dart
✅ lib/services/firestore_service.dart
✅ lib/screens/admin/admin_create_to_screen.dart
✅ lib/screens/admin/admin_to_list_screen.dart
```

---

## 3. 추가 논의 사항

### 3.1 급여 정보 개선 🔴 (우선순위 1)

#### 3.1.1 시급/일급/월급 선택
```
💰 급여 정보
┌─────────────────────────────┐
│ 금액: [15,000] 원            │
│                             │
│ 단위: ◉ 시급  ○ 일급  ○ 월급│
└─────────────────────────────┘
```

**WorkDetailModel 수정:**
```dart
class WorkDetailModel {
  final String workType;
  final int wage;
  final String wageType;  // ✅ NEW: "hourly", "daily", "monthly"
  // ...
}
```

#### 3.1.2 급여 입력 통화 형식
```dart
// 현재
입력: 15000
표시: 15000원

// 개선
입력: 15000
표시: 15,000원 (실시간 포맷팅)

// 구현
TextFormField(
  keyboardType: TextInputType.number,
  inputFormatters: [
    FilteringTextInputFormatter.digitsOnly,
    CurrencyInputFormatter(),
  ],
  decoration: InputDecoration(
    suffix: Text('원'),
  ),
)
```

#### 3.1.3 급여 지급 기준
```
💳 급여 지급
┌─────────────────────────────┐
│ ◉ 근무 당일 지급             │
│ ○ 근무 다음날 지급           │
│ ○ 주급 (매주 금요일)         │
│ ○ 월급 (매월 25일)           │
│ ○ 직접 입력: [________]     │
│                             │
│ 예: "근무 후 3일 이내"       │
└─────────────────────────────┘
```

**TOModel 확장:**
```dart
class TOModel {
  // 기존 필드...
  final String? paymentTiming;   // ✅ NEW
  final String? paymentDetail;   // ✅ NEW
}
```

---

### 3.2 근무 형태 선택 🔴 (우선순위 1)

#### 케이스 A: 날짜별 개별 지원 (현재 구조)
```
공고: 10/25~10/27 피킹
지원자: 25일만, 26일만, 전부 가능
→ 날짜별 독립적 관리
```

#### 케이스 B: 전체 기간 연속 필수 (신규)
```
공고: 10/25~10/27 (3일 연속 필수)
지원자: 3일 모두 가능한 사람만 지원
→ 지원 시 전체 날짜 자동 확정
```

#### UI 제안
```
┌─────────────────────────────┐
│ 🔄 근무 형태                 │
│                             │
│ ◉ 날짜별 개별 지원 가능      │
│   (원하는 날짜만 선택)       │
│                             │
│ ○ 전체 기간 연속 근무 필수   │
│   (모든 날짜 출근 필수)      │
└─────────────────────────────┘
```

**데이터 구조:**
```dart
class TOModel {
  // ...
  final String workPattern;  // ✅ NEW: "flexible", "consecutive"
}
```

---

### 3.3 TO 카드에 업무 유형 표시 🟡 (우선순위 2)

#### 현재 문제
```
TO 카드에 업무 정보가 없음
→ 어떤 업무인지 목록에서 파악 어려움
```

#### 개선안
```
┌─────────────────────────────┐
│ 테스트1 물류센터             │
│ 테스트 그룹TO                │
│                             │
│ 📦 피킹  09:00~18:00        │  ← 추가
│    시급 15,000원            │  ← 추가
│                             │
│ 📅 10/25~10/27 (3일)        │
│ 👥 확정: 0/3               │
└─────────────────────────────┘
```

#### 구현 방법
```dart
// 1. WorkDetails 로드 추가
final workDetails = await _firestoreService.getWorkDetails(to.id);

// 2. _TOWithStats 클래스 수정
class _TOWithStats {
  final TOModel to;
  final List<WorkDetailModel> workDetails;  // ✅ 추가
  final int confirmedCount;
  final int pendingCount;
}

// 3. 카드 UI 수정
if (item.workDetails.isNotEmpty) {
  ...item.workDetails.map((work) {
    return Row(
      children: [
        Text(work.workTypeIcon),
        Text('${work.workType}  ${work.startTime}~${work.endTime}'),
        Text('${NumberFormat('#,###').format(work.wage)}원'),
      ],
    );
  }).toList(),
}
```

---

## 4. 단기 TO 시스템 (현재)

### 4.1 특징
```
📦 단기 TO
├─ 기간: 1일 ~ 30일
├─ 급여: 시급/일급
├─ 지원: 날짜별 선택 가능
├─ 확정: 즉시
└─ 관리: 간단
```

### 4.2 화면 구성
```
관리자
├─ TO 생성 (단일/범위)
├─ TO 목록
├─ 날짜별 상세 (그룹 TO)
└─ 지원자 관리

지원자
├─ TO 검색/목록
├─ 날짜 선택 (그룹 TO)
└─ 지원하기
```

### 4.3 남은 작업

#### 🟡 우선순위 2
- [ ] 날짜별 상세 화면 (그룹 TO 클릭 시)
- [ ] 그룹 삭제 기능

#### 🟢 우선순위 3
- [ ] 그룹 수정 기능
- [ ] 날짜 추가 기능
- [ ] 지원자 날짜 선택 UI

---

## 5. 장기 채용 시스템 (신규)

### 5.1 장기 vs 단기 비교

| 구분 | 단기 TO | 장기 채용 |
|------|---------|----------|
| **기간** | 1~30일 | 1개월 이상 |
| **급여** | 시급/일급 | 월급 |
| **지원** | 날짜별 선택 | 전체 기간 필수 |
| **확정** | 즉시 | 면접 → 합격 |
| **관리** | TO별 | 근태/급여 |
| **계약** | 없음 | 필요 |

### 5.2 별도 컬렉션 설계 (추천)

#### Firestore 구조
```
📂 tos (단기 TO)
├─ to_id_1
└─ to_id_2

📂 long_term_jobs (장기 채용) ✨
├─ job_id_1
│  ├─ title: "매장 관리 직원"
│  ├─ startDate: 2025-11-01
│  ├─ endDate: 2025-12-31
│  ├─ monthlySalary: 2500000
│  ├─ workDays: ["월","화","수","목","금"]
│  ├─ workTime: "09:00~18:00"
│  └─ attendances (하위 컬렉션)
│     ├─ attendance_id_1
│     └─ attendance_id_2
└─ job_id_2

📂 applications (공통 사용)
├─ app_id_1
│  ├─ type: "TO" 또는 "LONG_TERM"
│  ├─ targetId: to_id 또는 job_id
│  └─ status: "PENDING", "CONFIRMED", etc.
```

#### 별도 컬렉션 이유
```
✅ 명확한 책임 분리
✅ 각자 최적화 가능
✅ 유지보수 용이
✅ 확장성 높음

⚠️ 단점: 컬렉션 2개 관리
→ 해결: 공통 인터페이스 사용
```

---

### 5.3 LongTermJob 모델

```dart
class LongTermJob {
  final String id;
  final String businessId;
  final String businessName;
  final String title;
  
  // 기간
  final DateTime startDate;
  final DateTime endDate;
  
  // 근무 조건
  final List<String> workDays;      // ["월", "화", "수", "목", "금"]
  final String workStartTime;       // "09:00"
  final String workEndTime;         // "18:00"
  
  // 급여
  final int monthlySalary;          // 2,500,000
  final String salaryType;          // "monthly"
  final String paymentDay;          // "매월 25일"
  
  // 모집
  final int requiredCount;          // 2명
  final int confirmedCount;         // 1명
  final DateTime recruitDeadline;
  
  // 상태
  final String status;              // "RECRUITING", "IN_PROGRESS", "COMPLETED"
  
  // 요구 서류
  final List<String> requiredDocuments;  // ["이력서", "자기소개서"]
  
  // 복리후생
  final bool hasFourInsurance;      // 4대보험 여부
  
  final DateTime createdAt;
  final String creatorUID;
}
```

---

### 5.4 관리자 화면 구조

```
관리자 메뉴
├─ 📦 단기 TO 관리
│  ├─ TO 목록/생성
│  ├─ 지원자 관리
│  └─ 당일 TO 현황
│
├─ 💼 장기 채용 관리 ✨ (신규)
│  ├─ 채용 공고 목록/등록
│  ├─ 지원자 관리
│  ├─ 근태 관리
│  └─ 급여 정산
│
├─ 👥 근로자 관리
├─ 🏢 사업장 관리
└─ 📊 통합 통계
```

#### 새 화면 목록
```
lib/screens/admin/long_term/
├─ long_term_job_list_screen.dart          // 공고 목록
├─ create_long_term_job_screen.dart        // 공고 등록
├─ long_term_job_detail_screen.dart        // 공고 상세
├─ long_term_applicants_screen.dart        // 지원자 관리
├─ attendance_management_screen.dart       // 근태 관리 ✨
└─ salary_calculation_screen.dart          // 급여 정산 ✨
```

---

### 5.5 장기 채용 공고 등록 화면

```
┌─────────────────────────────────┐
│ ← 장기 채용 공고 등록            │
├─────────────────────────────────┤
│ 🏢 사업장: [테스트1 ▼]         │
│                                 │
│ 📝 공고 제목:                    │
│ [매장 관리 직원 모집]           │
│                                 │
│ 📅 근무 기간:                    │
│ 시작: [2025-11-01]              │
│ 종료: [2025-12-31]              │
│ → 총 2개월 근무                  │
│                                 │
│ 📋 근무 요일:                    │
│ ☑ 월 ☑ 화 ☑ 수 ☑ 목 ☑ 금      │
│ ☐ 토 ☐ 일                       │
│                                 │
│ ⏰ 근무 시간:                    │
│ [09:00] ~ [18:00]               │
│                                 │
│ 💰 월급: [2,500,000] 원         │
│ 지급일: [매월 25일 ▼]           │
│ ☑ 4대보험 가입                   │
│                                 │
│ 👥 모집 인원: [2] 명            │
│                                 │
│ 🕐 마감: [2025-10-30 18:00]     │
│                                 │
│ 📄 업무 내용:                    │
│ [                              ]│
│                                 │
│ 📎 요구 서류:                    │
│ ☑ 이력서  ☑ 자기소개서          │
│ ☐ 경력증명서  ☐ 자격증           │
│                                 │
│ [등록하기]                       │
└─────────────────────────────────┘
```

---

### 5.6 근태 관리 화면 (신규!)

```
┌─────────────────────────────────┐
│ ← 근태 관리 - 김철수             │
├─────────────────────────────────┤
│ 👤 김철수                        │
│ 💼 매장 관리 직원                │
│ 📅 10/01~12/31                  │
│                                 │
│ 📊 출근 통계                     │
│ • 총 근무: 26일 / 66일          │
│ • 출근: 24일 ✅                  │
│ • 결근: 2일 ❌                   │
│ • 지각: 1일 ⚠️                  │
│                                 │
│ 📅 2025년 10월                   │
│                                 │
│ 월   화   수   목   금   토   일  │
│ 1    2    3    4    5    6    7 │
│ ✅   ✅   ⚠️   ✅   ❌   🏠   🏠│
│                                 │
│ 최근 기록:                       │
│ 10/25 (금) ✅ 09:05~18:03       │
│ 10/24 (목) ⚠️ 09:15~18:00 지각 │
│ 10/23 (수) ✅ 09:00~18:05       │
│ 10/22 (화) ❌ 결근 (사유: 개인) │
│                                 │
│ [출근 기록 수정] [급여 계산]     │
└─────────────────────────────────┘
```

---

### 5.7 급여 정산 화면 (신규!)

```
┌─────────────────────────────────┐
│ ← 급여 정산 - 2025년 10월        │
├─────────────────────────────────┤
│ 📊 총 지급: 5,400,000원         │
│ 지급 완료: 2명 | 대기: 1명      │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ 👤 김철수 - 매장 관리        │ │
│ │                             │ │
│ │ 💰 기본급: 2,500,000원      │ │
│ │ ➕ 주휴수당: 0원             │ │
│ │ ➖ 결근 차감: -100,000원     │ │
│ │ ➖ 4대보험: -250,000원       │ │
│ │ ━━━━━━━━━━━━━━━━━━━━━━━━ │ │
│ │ 💵 실수령: 2,150,000원      │ │
│ │                             │ │
│ │ 📅 지급일: 10/25             │ │
│ │ 상태: ⏳ 지급 대기           │ │
│ │                             │ │
│ │ [지급 완료 처리]             │ │
│ └─────────────────────────────┘ │
│                                 │
│ [명세서 출력] [회계 전송]        │
└─────────────────────────────────┘
```

---

### 5.8 지원자 입장 화면 비교

#### 단기 TO 카드
```
┌─────────────────────────────────┐
│ 📦 TO - 단기 알바                │
│ ─────────────────────────────── │
│ 테스트1 물류센터                 │
│ 피킹 업무                        │
│                                 │
│ 📅 10/25~10/27 (날짜 선택 가능) │
│ 💰 시급 15,000원                │
│ ⏰ 09:00~18:00                  │
│ 👥 남은 자리: 3/5               │
│ 💳 근무 당일 지급                │
│                                 │
│ [지원하기]                       │
└─────────────────────────────────┘
```

#### 장기 채용 카드
```
┌─────────────────────────────────┐
│ 💼 장기 근무                     │
│ ─────────────────────────────── │
│ 테스트1 물류센터                 │
│ 매장 관리 직원                   │
│                                 │
│ 📅 11/01~12/31 (2개월 근무)     │
│ 💰 월급 2,500,000원             │
│ ⏰ 월~금 09:00~18:00            │
│ 👥 모집: 1/2명                  │
│ 💳 매월 25일 지급                │
│ 📋 주 5일 근무                   │
│                                 │
│ [지원하기]                       │
└─────────────────────────────────┘
```

#### 시각적 구분
```
단기 TO:
- 색상: 파란색 (Blue)
- 아이콘: 📦 / ⏰
- 뱃지: "날짜 선택 가능"

장기 채용:
- 색상: 초록색 (Green)
- 아이콘: 💼 / 📋
- 뱃지: "전체 기간 필수"
```

---

## 6. 구현 우선순위

### 🔴 Phase A: 단기 TO 개선 (우선!)

#### A-1. 급여 정보 개선 (2~3일)
- [ ] 시급/일급/월급 선택 버튼
- [ ] 급여 통화 형식 (15,000원)
- [ ] 급여 지급 기준 입력

#### A-2. 근무 형태 선택 (1일)
- [ ] 개별 지원 / 연속 필수 토글
- [ ] workPattern 필드 추가

#### A-3. TO 카드 업무 표시 (1일)
- [ ] WorkDetails 로드
- [ ] 카드 UI에 업무 정보 표시

**예상 기간**: 4~5일

---

### 🟡 Phase B: 단기 TO 완성 (중요)

#### B-1. 날짜별 상세 화면 (2일)
- [ ] admin_group_to_detail_screen.dart 생성
- [ ] 날짜별 통계 표시
- [ ] 날짜 클릭 → 지원자 관리

#### B-2. 그룹 삭제 기능 (1일)
- [ ] 그룹 전체 삭제
- [ ] 특정 날짜 삭제
- [ ] 확정자 경고

#### B-3. 지원자 날짜 선택 UI (2일)
- [ ] user 화면에서 그룹 TO 표시
- [ ] 날짜 선택 화면
- [ ] 복수 날짜 지원

**예상 기간**: 5일

---

### 🟢 Phase C: 장기 채용 시스템 (나중에)

#### C-1. 데이터 구조 (1일)
- [ ] LongTermJob 모델 생성
- [ ] long_term_jobs 컬렉션 설계
- [ ] AttendanceRecord 모델

#### C-2. 공고 관리 (3일)
- [ ] 공고 등록 화면
- [ ] 공고 목록 화면
- [ ] 공고 상세 화면

#### C-3. 지원자 관리 (2일)
- [ ] 지원서 접수
- [ ] 면접 일정 관리
- [ ] 합격/불합격 처리

#### C-4. 근태 관리 (3일)
- [ ] 출근 기록 시스템
- [ ] 근태 캘린더
- [ ] 통계 계산

#### C-5. 급여 정산 (2일)
- [ ] 급여 계산 로직
- [ ] 명세서 생성
- [ ] 지급 처리

#### C-6. 지원자 화면 (2일)
- [ ] 장기 공고 목록
- [ ] 상세 보기
- [ ] 지원 프로세스

**예상 기간**: 13일

---

### 📊 전체 타임라인

```
Week 1-2: Phase A (급여/근무형태/카드)  ← 지금!
Week 3: Phase B (날짜별 상세/삭제)
Week 4-5: Phase C (장기 채용 시스템)

총 예상 기간: 22~24일
```

---

## 7. 데이터베이스 구조

### 7.1 단기 TO (tos)

```dart
{
  "id": "to_id_1",
  "businessId": "biz_123",
  "businessName": "테스트1 물류센터",
  "title": "피킹 모집",
  
  // 그룹
  "groupId": "group_xxx",        // nullable
  "groupName": "피킹 그룹",      // nullable
  "startDate": "2025-10-25",     // nullable
  "endDate": "2025-10-27",       // nullable
  "isGroupMaster": true,
  
  // 기본 정보
  "date": "2025-10-25",
  "applicationDeadline": "2025-10-24 18:00",
  "totalRequired": 5,
  "totalConfirmed": 0,
  
  // ✅ NEW: 급여 지급
  "paymentTiming": "당일",       // nullable
  "paymentDetail": "근무 후 당일 지급",  // nullable
  
  // ✅ NEW: 근무 형태
  "workPattern": "flexible",     // "flexible" | "consecutive"
  
  // 기타
  "description": "...",
  "creatorUID": "user_123",
  "createdAt": timestamp,
  
  // workDetails (하위 컬렉션)
  "workDetails": [
    {
      "workType": "피킹",
      "workTypeIcon": "📦",
      "workTypeColor": "#FF5722",
      "wage": 15000,
      "wageType": "hourly",      // ✅ NEW
      "requiredCount": 5,
      "confirmedCount": 0,
      "startTime": "09:00",
      "endTime": "18:00",
      "order": 0
    }
  ]
}
```

---

### 7.2 장기 채용 (long_term_jobs)

```dart
{
  "id": "job_id_1",
  "businessId": "biz_123",
  "businessName": "테스트1 매장",
  "title": "매장 관리 직원",
  
  // 기간
  "startDate": "2025-11-01",
  "endDate": "2025-12-31",
  
  // 근무 조건
  "workDays": ["월", "화", "수", "목", "금"],
  "workStartTime": "09:00",
  "workEndTime": "18:00",
  
  // 급여
  "monthlySalary": 2500000,
  "salaryType": "monthly",
  "paymentDay": "매월 25일",
  "hasFourInsurance": true,
  
  // 모집
  "requiredCount": 2,
  "confirmedCount": 1,
  "recruitDeadline": "2025-10-30 18:00",
  
  // 상태
  "status": "RECRUITING",        // RECRUITING, IN_PROGRESS, COMPLETED
  
  // 서류
  "requiredDocuments": ["이력서", "자기소개서"],
  
  // 기타
  "description": "...",
  "creatorUID": "user_123",
  "createdAt": timestamp,
  
  // attendances (하위 컬렉션)
  "attendances": [
    {
      "userId": "user_456",
      "date": "2025-11-01",
      "checkIn": "09:05",
      "checkOut": "18:03",
      "status": "PRESENT",        // PRESENT, ABSENT, LATE
      "note": ""
    }
  ]
}
```

---

### 7.3 Applications (공통)

```dart
{
  "id": "app_id_1",
  "type": "TO",                  // ✅ "TO" | "LONG_TERM"
  "targetId": "to_id_1",         // to_id 또는 job_id
  
  "userId": "user_456",
  "userName": "김철수",
  "userPhone": "010-1234-5678",
  
  // 단기 TO용
  "selectedWorkType": "피킹",     // TO일 때만
  "wage": 15000,                 // TO일 때만
  
  // 장기 채용용
  "resume": "...",               // LONG_TERM일 때만
  "coverLetter": "...",          // LONG_TERM일 때만
  "documents": [],               // LONG_TERM일 때만
  
  // 공통
  "status": "PENDING",           // PENDING, CONFIRMED, REJECTED, INTERVIEW
  "appliedAt": timestamp,
  "updatedAt": timestamp
}
```

---

## 8. 화면 설계

### 8.1 관리자 홈 (통합 대시보드)

```
┌─────────────────────────────────┐
│ 📱 관리자 홈                     │
├─────────────────────────────────┤
│ 📦 오늘의 단기 TO                │
│ 진행: 3건 | 확정: 15/20명       │
│ [상세보기]                       │
│                                 │
│ 💼 장기 채용 현황                │
│ 모집: 2건 | 근무: 3명           │
│ [상세보기]                       │
│                                 │
│ 👥 전체 근로자                   │
│ 단기: 25명 | 장기: 3명          │
│                                 │
│ 💰 이번 달 인건비                │
│ 단기: 15,000,000원              │
│ 장기: 7,500,000원               │
│ 합계: 22,500,000원              │
└─────────────────────────────────┘
```

---

### 8.2 지원자 - 내 지원 현황

```
┌─────────────────────────────────┐
│ 나의 지원 현황                   │
├─────────────────────────────────┤
│ 📦 단기 TO (3건)                 │
│ ─────────────────────────────── │
│ • 10/25 피킹 - 확정 ✅           │
│ • 10/26 배송 - 대기 ⏳           │
│ • 10/27 피킹 - 거절 ❌           │
│                                 │
│ 💼 장기 근무 (1건)               │
│ ─────────────────────────────── │
│ • 매장 관리 (11/01~12/31)       │
│   상태: 면접 예정 📋             │
│   면접일: 10/30 14:00           │
└─────────────────────────────────┘
```

---

## 9. 개발 로드맵

### Milestone 1: 단기 TO 완성 (Week 1-3)
```
✅ Phase 1: 그룹화 기능 (완료)
🔴 Phase A: 급여/근무형태 개선
🟡 Phase B: 날짜별 상세/삭제
```

### Milestone 2: 장기 채용 MVP (Week 4-5)
```
🟢 Phase C-1: 데이터 구조
🟢 Phase C-2: 공고 관리
🟢 Phase C-3: 지원자 관리
```

### Milestone 3: 장기 채용 완성 (Week 6)
```
🟢 Phase C-4: 근태 관리
🟢 Phase C-5: 급여 정산
🟢 Phase C-6: 지원자 화면
```

### Milestone 4: 통합 & 테스트 (Week 7)
```
- 단기/장기 통합 대시보드
- 전체 테스트
- 버그 수정
- 성능 최적화
```

---

## 10. 체크리스트

### ✅ 완료
- [x] TO 모델 그룹화
- [x] 날짜 범위 TO 생성
- [x] 실시간 검증 (30일, 마감시간)
- [x] TO 목록 그룹 표시
- [x] FirestoreService 그룹 메서드

### 🔴 진행 중 (Phase A)
- [ ] 시급/일급/월급 선택
- [ ] 급여 통화 형식
- [ ] 급여 지급 기준
- [ ] 근무 형태 선택
- [ ] TO 카드 업무 표시

### 🟡 대기 (Phase B)
- [ ] 날짜별 상세 화면
- [ ] 그룹 삭제 기능
- [ ] 지원자 날짜 선택 UI

### 🟢 계획 (Phase C)
- [ ] 장기 채용 데이터 구조
- [ ] 공고 등록/관리
- [ ] 근태 관리
- [ ] 급여 정산

---

## 11. 주요 의사결정

### ✅ 확정된 결정

1. **그룹화 방식**: groupId로 연결 (isGroupMaster 사용)
2. **날짜 제한**: 최대 30일
3. **마감시간**: 종료일 당일까지 허용
4. **장기 채용**: 별도 컬렉션 사용 (tos와 분리)
5. **Applications**: 단기/장기 공통 사용 (type 필드로 구분)

### 🤔 검토 필요

1. **근무 형태 기본값**: flexible vs consecutive?
2. **급여 지급 기본값**: 어떤 옵션?
3. **장기 채용 시작 시점**: Phase B 이후? 별도 프로젝트?

---

## 12. 참고 자료

### 관련 문서
- [TO 그룹화 기능 설계서](./TO_그룹화_기능_설계서.md)
- [중간 보고서 Phase 1-2-7](./중간_보고서_Phase1_2_7_완료_v3_0.md)

### 주요 파일
```
lib/
├── models/
│   ├── to_model.dart                    ✅
│   ├── long_term_job_model.dart         🟢 NEW
│   └── attendance_record_model.dart     🟢 NEW
│
├── services/
│   ├── firestore_service.dart           ✅
│   └── long_term_service.dart           🟢 NEW
│
├── screens/
│   ├── admin/
│   │   ├── to/
│   │   │   ├── admin_create_to_screen.dart         ✅
│   │   │   ├── admin_to_list_screen.dart           ✅
│   │   │   ├── admin_to_detail_screen.dart         ✅
│   │   │   └── admin_group_to_detail_screen.dart   🟡 NEW
│   │   │
│   │   └── long_term/                              🟢 NEW
│   │       ├── long_term_job_list_screen.dart
│   │       ├── create_long_term_job_screen.dart
│   │       ├── long_term_job_detail_screen.dart
│   │       ├── long_term_applicants_screen.dart
│   │       ├── attendance_management_screen.dart
│   │       └── salary_calculation_screen.dart
│   │
│   └── user/
│       ├── all_to_list_screen.dart                 🟡 수정 필요
│       └── group_to_date_selection_screen.dart     🟡 NEW
```

---

## 부록 A: 코드 스니펫

### A-1. 통화 형식 포맷터

```dart
class CurrencyInputFormatter extends TextInputFormatter {
  @override
  TextEditingValue formatEditUpdate(
    TextEditingValue oldValue,
    TextEditingValue newValue,
  ) {
    if (newValue.text.isEmpty) return newValue;
    
    final number = int.parse(newValue.text.replaceAll(',', ''));
    final formatted = NumberFormat('#,###').format(number);
    
    return TextEditingValue(
      text: formatted,
      selection: TextSelection.collapsed(offset: formatted.length),
    );
  }
}
```

### A-2. 급여 단위 선택 위젯

```dart
Widget _buildWageTypeSelector() {
  return Row(
    children: [
      _buildWageTypeChip('시급', 'hourly'),
      const SizedBox(width: 8),
      _buildWageTypeChip('일급', 'daily'),
      const SizedBox(width: 8),
      _buildWageTypeChip('월급', 'monthly'),
    ],
  );
}

Widget _buildWageTypeChip(String label, String type) {
  final isSelected = _selectedWageType == type;
  
  return ChoiceChip(
    label: Text(label),
    selected: isSelected,
    onSelected: (selected) {
      setState(() {
        _selectedWageType = type;
      });
    },
  );
}
```

### A-3. 근무 형태 선택

```dart
String _workPattern = 'flexible';  // 'flexible' | 'consecutive'

RadioListTile<String>(
  title: const Text('날짜별 개별 지원 가능'),
  subtitle: const Text('지원자가 원하는 날짜만 선택'),
  value: 'flexible',
  groupValue: _workPattern,
  onChanged: (value) {
    setState(() => _workPattern = value!);
  },
),

RadioListTile<String>(
  title: const Text('전체 기간 연속 근무 필수'),
  subtitle: const Text('모든 날짜 출근 필수'),
  value: 'consecutive',
  groupValue: _workPattern,
  onChanged: (value) {
    setState(() => _workPattern = value!);
  },
),
```

---

**작성일**: 2025-10-27  
**최종 수정**: 2025-10-27  
**작성자**: 개발팀  
**문서 버전**: v4.0 (통합본)

---

## 📝 변경 이력

| 버전 | 날짜 | 내용 |
|------|------|------|
| v1.0 | 2025-10-24 | 초안 - 그룹화 기능 설계 |
| v2.0 | 2025-10-24 | Phase 1 완료 반영 |
| v3.0 | 2025-10-24 | 중간 보고서 통합 |
| v4.0 | 2025-10-27 | 급여/장기채용 논의 통합 ✨ |
