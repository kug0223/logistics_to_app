# 📋 TO 시스템 통합 설계서 v5.0

**작성일**: 2025년 10월 27일  
**문서 버전**: v5.0 (최종 확정본)  
**작성자**: 개발팀  
**주요 변경**: 탭 구조 도입, 법정 급여 계산 추가

---

## 📌 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [완료된 작업 (Phase 1)](#2-완료된-작업-phase-1)
3. [핵심 방향 전환](#3-핵심-방향-전환)
4. [채용 유형 시스템](#4-채용-유형-시스템)
5. [법정 급여 관리](#5-법정-급여-관리)
6. [데이터베이스 구조](#6-데이터베이스-구조)
7. [화면 설계](#7-화면-설계)
8. [구현 로드맵](#8-구현-로드맵)
9. [코드 스니펫](#9-코드-스니펫)

---

## 1. 프로젝트 개요

### 1.1 시스템 목적
물류센터 및 사업장의 **단기/장기 근무자 통합 관리** 시스템

### 1.2 채용 유형 (최종 확정)
```
📦 단기 (1일~30일)
├─ 캘린더 방식 날짜 선택
├─ 연속/비연속 가능
├─ 시급/일급
└─ 주휴수당 자동 계산

💼 1개월 이상 (~6개월)
├─ 요일 선택 방식
├─ 월급
├─ 근태 관리
└─ 4대보험 포함

❌ 정직원 (제외)
└─ Phase 2 이후 검토
```

### 1.3 핵심 기능
- **탭 구조** (단기 / 1개월+)
- **법정 최저시급** 검증
- **주휴수당** 자동 계산
- **예상 급여** 실시간 표시
- **캘린더 날짜 선택** (단기)
- **요일 선택** (1개월+)

---

## 2. 완료된 작업 (Phase 1)

### 2.1 TO 모델 그룹화 ✅

```dart
class TOModel {
  // 그룹 관련
  final String? groupId;
  final String? groupName;
  final DateTime? startDate;
  final DateTime? endDate;
  final bool isGroupMaster;
  
  // Getter
  bool get isGroupTO => groupId != null;
  String? get groupPeriodString => "10/25~10/27";
  int? get groupDaysCount => 3;
}
```

### 2.2 날짜 범위 TO 생성 ✅

#### 생성 화면
```
┌─────────────────────────────┐
│ 📅 근무 날짜                 │
│ ┌───────────┬───────────┐   │
│ │ 단일 날짜 │ 날짜 범위 │   │
│ └───────────┴───────────┘   │
└─────────────────────────────┘
```

#### 검증 로직
- 최대 30일 제한 (실시간 경고)
- 마감시간 종료일 당일까지 허용
- 종료일 ≥ 시작일 체크

### 2.3 TO 목록 그룹 표시 ✅

```
┌─────────────────────────────┐
│ 테스트1 물류센터             │
│ 테스트 그룹TO                │
│ 📅 10/25~10/27 (3일)        │
│ ⏰ 09:00 ~ 18:00            │
│ 👥 확정: 0/1               │
└─────────────────────────────┘
```

### 2.4 완료된 파일
```
✅ lib/models/to_model.dart
✅ lib/services/firestore_service.dart
✅ lib/screens/admin/admin_create_to_screen.dart
✅ lib/screens/admin/admin_to_list_screen.dart
```

---

## 3. 핵심 방향 전환

### 3.1 기존 방향 (변경 전)

```
❌ 문제점:
- 단기 TO와 장기 채용이 혼재
- 정직원까지 포함하려니 복잡도 폭발
- 근태/급여 시스템까지 필요
```

### 3.2 새로운 방향 (변경 후)

```
✅ 개선:
- 단기(~30일) + 1개월+(~6개월)만 집중
- 정직원은 제외 (채용 플랫폼 성격 다름)
- 탭 구조로 명확한 구분
- 법정 급여 관리 강화
```

### 3.3 벤치마킹: 당근마켓 구인공고

#### 당근의 3단계 구조
```
┌──────┬──────┬──────┐
│ 단기 │1개월+│정직원│
└──────┴──────┴──────┘
```

#### 우리의 2단계 구조 (확정)
```
┌──────┬──────┐
│ 단기 │1개월+│
└──────┴──────┘
```

**선택 이유:**
- ✅ 명확한 타겟 (단기/계약직 중심)
- ✅ 복잡도 감소
- ✅ 빠른 MVP 출시
- ✅ 핵심 기능 집중

---

## 4. 채용 유형 시스템

### 4.1 전체 구조

```
공고 등록 화면
┌─────────────────────────────┐
│ ┌──────┬──────┐             │
│ │ 단기 │1개월+│             │
│ └──────┴──────┘             │
│   ▲ 탭 선택                  │
├─────────────────────────────┤
│                             │
│ [탭별 폼 내용]               │
│                             │
└─────────────────────────────┘
```

---

### 4.2 단기 탭 (1일~30일)

#### 특징
```
📦 단기 알바
├─ 기간: 1~30일
├─ 날짜: 캘린더에서 복수 선택
├─ 급여: 시급/일급
├─ 패턴: 연속/비연속 가능
└─ 계산: 주휴수당 자동
```

#### 화면 설계
```
┌─────────────────────────────────┐
│ ┌──────┬──────┐                 │
│ │ 단기 │1개월+│                 │
│ └──────┴──────┘                 │
├─────────────────────────────────┤
│                                 │
│ 🏢 사업장: [테스트1 ▼]          │
│                                 │
│ 📝 공고 제목:                    │
│ [피킹 보조 구합니다]             │
│                                 │
│ 📅 근무 날짜 선택                │
│ ┌─────────────────────────┐   │
│ │ 2025년 10월               │   │
│ │                          │   │
│ │  일  월  화  수  목  금  토│   │
│ │        1   2   3   4   5 │   │
│ │  6   7   8   9  10  11  12│   │
│ │ 13  14  15  16  17  18  19│   │
│ │ 20  21  22  23  24  25  26│   │
│ │ 27  28  29  30  31       │   │
│ │                          │   │
│ │ ☑25  ☐26  ☑27  ☐28  ☑29 │   │
│ │                          │   │
│ │ ✓ 선택: 25, 27, 29일 (3일)│   │
│ └─────────────────────────┘   │
│                                 │
│ 💰 시급                          │
│ ┌─────────────────────────┐   │
│ │ [15,000] 원               │   │
│ │                          │   │
│ │ ℹ️ 2025년 최저시급: 10,030원│   │
│ │                          │   │
│ │ 📊 예상 급여 (1일 8시간)  │   │
│ │ ━━━━━━━━━━━━━━━━━━━━━ │   │
│ │ 일급: 120,000원          │   │
│ │ 3일 총액: 360,000원      │   │
│ │                          │   │
│ │ 💡 주휴수당 포함 시:     │   │
│ │    일급: 144,000원       │   │
│ │    3일 총액: 432,000원   │   │
│ │                          │   │
│ │ ⓘ 주 15시간 이상 근무 시  │   │
│ │   주휴수당 자동 포함     │   │
│ └─────────────────────────┘   │
│                                 │
│ ⏰ 근무 시간:                    │
│ [09:00] ~ [18:00]               │
│                                 │
│ 💳 급여 지급:                    │
│ ○ 근무 당일                      │
│ ● 근무 다음날                    │
│ ○ 주급 (매주 금요일)            │
│ ○ 직접 입력: [________]         │
│                                 │
│ 📋 업무 내용:                    │
│ [피킹 작업 보조...]             │
│                                 │
│ [등록하기]                       │
└─────────────────────────────────┘
```

#### 데이터 구조
```dart
class ShortTermTO {
  final String jobType = "short";
  final List<DateTime> selectedDates;  // 캘린더 선택 날짜
  final int hourlyWage;                // 시급
  final String startTime;
  final String endTime;
  final String paymentTiming;          // 지급 시기
  final bool includesWeeklyHolidayPay; // 주휴수당 포함
}
```

---

### 4.3 1개월 이상 탭

#### 특징
```
💼 1개월+ 계약직
├─ 기간: 1~6개월
├─ 요일: 월~일 선택
├─ 급여: 월급
├─ 복리: 4대보험 포함
└─ 관리: 근태 시스템
```

#### 화면 설계
```
┌─────────────────────────────────┐
│ ┌──────┬──────┐                 │
│ │ 단기 │1개월+│                 │
│ └──────┴──────┘                 │
├─────────────────────────────────┤
│                                 │
│ 🏢 사업장: [테스트1 ▼]          │
│                                 │
│ 📝 공고 제목:                    │
│ [매장 관리 직원 모집]            │
│                                 │
│ 📅 근무 기간                     │
│ 시작: [2025-11-01]              │
│ 종료: [2026-01-31]              │
│ → 총 3개월 근무                  │
│                                 │
│ 📋 근무 요일                     │
│ ┌─────────────────────────┐   │
│ │ ☑ 월  ☑ 화  ☑ 수  ☑ 목   │   │
│ │ ☑ 금  ☐ 토  ☐ 일         │   │
│ │                          │   │
│ │ → 주 5일 근무             │   │
│ └─────────────────────────┘   │
│                                 │
│ ⏰ 근무 시간:                    │
│ [09:00] ~ [18:00] (8시간)       │
│                                 │
│ 💰 월급                          │
│ ┌─────────────────────────┐   │
│ │ [2,500,000] 원            │   │
│ │                          │   │
│ │ 📊 법정 급여 확인         │   │
│ │ ━━━━━━━━━━━━━━━━━━━━━ │   │
│ │ 주 40시간 (8시간 × 5일)  │   │
│ │ 월 소정근로: 174시간     │   │
│ │                          │   │
│ │ 시급 환산: 14,368원      │   │
│ │ ✅ 최저시급(10,030원) 이상│   │
│ │                          │   │
│ │ ⓘ 주휴수당 포함됨        │   │
│ │ ⓘ 주휴일: 토, 일         │   │
│ └─────────────────────────┘   │
│                                 │
│ 💳 급여 지급일:                  │
│ [매월 25일 ▼]                   │
│                                 │
│ 🏥 복리후생                      │
│ ☑ 4대보험 가입                   │
│ ☐ 식대 지원 (월 [100,000]원)    │
│ ☐ 교통비 지원                    │
│ ☐ 연차 사용 가능                 │
│                                 │
│ 📋 업무 내용:                    │
│ [매장 관리 및 고객 응대...]      │
│                                 │
│ [등록하기]                       │
└─────────────────────────────────┘
```

#### 데이터 구조
```dart
class LongTermJob {
  final String jobType = "long_term";
  final DateTime startDate;
  final DateTime endDate;
  final List<String> workDays;        // ["월", "화", "수", "목", "금"]
  final String workStartTime;
  final String workEndTime;
  final int monthlySalary;            // 월급
  final String paymentDay;            // "매월 25일"
  final bool hasFourInsurance;        // 4대보험
  final List<String> benefits;        // 복리후생
}
```

---

## 5. 법정 급여 관리

### 5.1 최저시급 (2025년 기준)

#### 상수 정의
```dart
class LaborStandards {
  // 2025년 최저시급
  static const int minimumWage2025 = 10030;
  
  // 월 소정근로시간 (주 40시간 기준)
  static const double monthlyStandardHours = 174.0;  // (40 × 52) / 12
  
  // 주휴수당 계산 기준
  static const int weeklyHolidayPayThreshold = 15;  // 주 15시간 이상
}
```

---

### 5.2 시급 검증

#### 검증 로직
```dart
class WageValidator {
  /// 시급이 최저시급 이상인지 확인
  static bool isValidHourlyWage(int wage) {
    return wage >= LaborStandards.minimumWage2025;
  }
  
  /// 경고 메시지 생성
  static String? getWageWarning(int wage) {
    if (wage < LaborStandards.minimumWage2025) {
      return '⚠️ 2025년 최저시급(${LaborStandards.minimumWage2025}원)보다 낮습니다.';
    }
    return null;
  }
  
  /// 권장 메시지 생성
  static String getWageInfo(int wage) {
    if (wage >= LaborStandards.minimumWage2025) {
      return 'ℹ️ 2025년 최저시급: ${LaborStandards.minimumWage2025}원';
    }
    return '';
  }
}
```

#### UI 반영
```dart
TextFormField(
  decoration: InputDecoration(
    labelText: '시급',
    suffix: const Text('원'),
    // 경고 메시지
    errorText: WageValidator.getWageWarning(_hourlyWage),
    // 안내 메시지
    helperText: WageValidator.getWageInfo(_hourlyWage),
  ),
  onChanged: (value) {
    setState(() {
      _hourlyWage = int.tryParse(value.replaceAll(',', '')) ?? 0;
    });
  },
)
```

---

### 5.3 주휴수당 계산

#### 계산 로직
```dart
class WeeklyHolidayPayCalculator {
  /// 주휴수당 계산
  /// 
  /// 조건: 주 15시간 이상 근무
  /// 계산식: (주 소정근로시간 / 40) × 8 × 시급
  /// 
  /// 예시:
  /// - 시급: 15,000원
  /// - 주 5일, 하루 4시간 (주 20시간)
  /// - 주휴수당 = (20 / 40) × 8 × 15,000 = 60,000원
  static int calculate({
    required int hourlyWage,
    required int weeklyHours,
  }) {
    // 주 15시간 미만이면 주휴수당 없음
    if (weeklyHours < LaborStandards.weeklyHolidayPayThreshold) {
      return 0;
    }
    
    // 주휴수당 = (주 소정근로시간 / 40) × 8 × 시급
    final holidayHours = (weeklyHours / 40) * 8;
    return (hourlyWage * holidayHours).round();
  }
  
  /// 주휴수당 포함 여부 확인
  static bool isEligible(int weeklyHours) {
    return weeklyHours >= LaborStandards.weeklyHolidayPayThreshold;
  }
  
  /// 설명 메시지
  static String getExplanation(int weeklyHours) {
    if (isEligible(weeklyHours)) {
      return 'ⓘ 주 15시간 이상 근무로 주휴수당이 포함됩니다.';
    } else {
      return 'ⓘ 주 15시간 미만 근무로 주휴수당이 제외됩니다.';
    }
  }
}
```

#### 예상 급여 계산 위젯
```dart
class ExpectedPayWidget extends StatelessWidget {
  final int hourlyWage;
  final int dailyHours;
  final int workDays;
  
  @override
  Widget build(BuildContext context) {
    final dailyPay = hourlyWage * dailyHours;
    final weeklyHours = dailyHours * workDays;
    
    final weeklyHolidayPay = WeeklyHolidayPayCalculator.calculate(
      hourlyWage: hourlyWage,
      weeklyHours: weeklyHours,
    );
    
    final dailyPayWithHoliday = dailyPay + (weeklyHolidayPay / workDays).round();
    final totalPay = dailyPay * workDays;
    final totalPayWithHoliday = totalPay + weeklyHolidayPay;
    
    return Container(
      padding: EdgeInsets.all(16),
      decoration: BoxDecoration(
        color: Colors.blue[50],
        borderRadius: BorderRadius.circular(8),
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            '📊 예상 급여 (1일 ${dailyHours}시간)',
            style: TextStyle(fontWeight: FontWeight.bold),
          ),
          Divider(),
          
          // 기본 급여
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Text('일급:'),
              Text('${NumberFormat('#,###').format(dailyPay)}원'),
            ],
          ),
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Text('${workDays}일 총액:'),
              Text('${NumberFormat('#,###').format(totalPay)}원'),
            ],
          ),
          
          // 주휴수당 포함
          if (weeklyHolidayPay > 0) ...[
            SizedBox(height: 8),
            Text(
              '💡 주휴수당 포함 시:',
              style: TextStyle(
                color: Colors.blue[700],
                fontWeight: FontWeight.bold,
              ),
            ),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Text('일급:'),
                Text(
                  '${NumberFormat('#,###').format(dailyPayWithHoliday)}원',
                  style: TextStyle(color: Colors.blue[700]),
                ),
              ],
            ),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Text('${workDays}일 총액:'),
                Text(
                  '${NumberFormat('#,###').format(totalPayWithHoliday)}원',
                  style: TextStyle(
                    color: Colors.blue[700],
                    fontWeight: FontWeight.bold,
                  ),
                ),
              ],
            ),
          ],
          
          SizedBox(height: 8),
          Text(
            WeeklyHolidayPayCalculator.getExplanation(weeklyHours),
            style: TextStyle(fontSize: 12, color: Colors.grey[700]),
          ),
        ],
      ),
    );
  }
}
```

---

### 5.4 월급 검증

#### 검증 로직
```dart
class MonthlySalaryValidator {
  /// 월급이 최저임금 이상인지 확인
  /// 
  /// 주 40시간 기준: 월 174시간
  /// 최저 월급 = 10,030원 × 174시간 = 1,745,220원
  static bool isValidMonthlySalary({
    required int monthlySalary,
    required int weeklyHours,
  }) {
    // 월 소정근로시간 계산
    final monthlyHours = (weeklyHours * 52) / 12;
    
    // 시급 환산
    final hourlyWageEquivalent = monthlySalary / monthlyHours;
    
    // 최저시급 이상인지 확인
    return hourlyWageEquivalent >= LaborStandards.minimumWage2025;
  }
  
  /// 주 근무시간 기준 최저 월급 계산
  static int getMinimumMonthlySalary(int weeklyHours) {
    final monthlyHours = (weeklyHours * 52) / 12;
    return (LaborStandards.minimumWage2025 * monthlyHours).ceil();
  }
  
  /// 시급 환산
  static int getHourlyWageEquivalent({
    required int monthlySalary,
    required int weeklyHours,
  }) {
    final monthlyHours = (weeklyHours * 52) / 12;
    return (monthlySalary / monthlyHours).round();
  }
  
  /// 검증 메시지
  static String? getValidationMessage({
    required int monthlySalary,
    required int weeklyHours,
  }) {
    final isValid = isValidMonthlySalary(
      monthlySalary: monthlySalary,
      weeklyHours: weeklyHours,
    );
    
    if (!isValid) {
      final minimum = getMinimumMonthlySalary(weeklyHours);
      return '⚠️ 주 ${weeklyHours}시간 기준 최저 월급은 ${NumberFormat('#,###').format(minimum)}원입니다.';
    }
    
    return null;
  }
}
```

#### 월급 정보 위젯
```dart
class MonthlySalaryInfoWidget extends StatelessWidget {
  final int monthlySalary;
  final int weeklyHours;
  
  @override
  Widget build(BuildContext context) {
    final monthlyHours = (weeklyHours * 52) / 12;
    final hourlyEquivalent = MonthlySalaryValidator.getHourlyWageEquivalent(
      monthlySalary: monthlySalary,
      weeklyHours: weeklyHours,
    );
    final isValid = MonthlySalaryValidator.isValidMonthlySalary(
      monthlySalary: monthlySalary,
      weeklyHours: weeklyHours,
    );
    
    return Container(
      padding: EdgeInsets.all(16),
      decoration: BoxDecoration(
        color: isValid ? Colors.green[50] : Colors.red[50],
        borderRadius: BorderRadius.circular(8),
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            '📊 법정 급여 확인',
            style: TextStyle(fontWeight: FontWeight.bold),
          ),
          Divider(),
          
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Text('주 ${weeklyHours}시간'),
              Text('월 ${monthlyHours.round()}시간'),
            ],
          ),
          
          SizedBox(height: 8),
          
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Text('시급 환산:'),
              Text(
                '${NumberFormat('#,###').format(hourlyEquivalent)}원',
                style: TextStyle(fontWeight: FontWeight.bold),
              ),
            ],
          ),
          
          SizedBox(height: 8),
          
          Row(
            children: [
              Icon(
                isValid ? Icons.check_circle : Icons.error,
                color: isValid ? Colors.green : Colors.red,
                size: 16,
              ),
              SizedBox(width: 4),
              Text(
                isValid 
                    ? '최저시급(${LaborStandards.minimumWage2025}원) 이상 ✅'
                    : '최저시급(${LaborStandards.minimumWage2025}원) 미달 ❌',
                style: TextStyle(
                  color: isValid ? Colors.green[700] : Colors.red[700],
                  fontSize: 12,
                ),
              ),
            ],
          ),
          
          SizedBox(height: 8),
          
          Text(
            'ⓘ 주휴수당 포함됨',
            style: TextStyle(fontSize: 12, color: Colors.grey[700]),
          ),
          Text(
            'ⓘ 주휴일: 토, 일',
            style: TextStyle(fontSize: 12, color: Colors.grey[700]),
          ),
        ],
      ),
    );
  }
}
```

---

## 6. 데이터베이스 구조

### 6.1 통합 컬렉션 (tos)

```dart
{
  "id": "to_id_1",
  "businessId": "biz_123",
  "businessName": "테스트1 물류센터",
  "title": "피킹 모집",
  
  // ✅ NEW: 채용 유형
  "jobType": "short",        // "short" | "long_term"
  
  // ========== 단기 전용 필드 ==========
  "selectedDates": [         // 캘린더 선택 날짜들
    "2025-10-25",
    "2025-10-27",
    "2025-10-29"
  ],
  "hourlyWage": 15000,       // 시급
  "dailyHours": 8,           // 1일 근무시간
  
  // ========== 1개월+ 전용 필드 ==========
  "startDate": "2025-11-01",
  "endDate": "2026-01-31",
  "workDays": ["월", "화", "수", "목", "금"],
  "monthlySalary": 2500000,
  "hasFourInsurance": true,
  "benefits": ["식대", "교통비"],
  
  // ========== 공통 필드 ==========
  "workStartTime": "09:00",
  "workEndTime": "18:00",
  "paymentTiming": "근무 다음날",
  "paymentDetail": "근무 다음날 오전 지급",
  "includesWeeklyHolidayPay": true,
  
  // 기존 필드
  "applicationDeadline": "2025-10-24 18:00",
  "totalRequired": 5,
  "totalConfirmed": 0,
  "description": "...",
  "creatorUID": "user_123",
  "createdAt": timestamp,
  
  // workDetails (하위 컬렉션)
  "workDetails": [...]
}
```

### 6.2 필드 사용 규칙

```
jobType이 "short"일 때:
✅ 필수: selectedDates, hourlyWage, dailyHours
❌ 무시: startDate, endDate, workDays, monthlySalary

jobType이 "long_term"일 때:
✅ 필수: startDate, endDate, workDays, monthlySalary
❌ 무시: selectedDates, hourlyWage, dailyHours
```

---

## 7. 화면 설계

### 7.1 관리자 - TO 생성 화면

```dart
class AdminCreateTOScreen extends StatefulWidget {
  @override
  State<AdminCreateTOScreen> createState() => _AdminCreateTOScreenState();
}

class _AdminCreateTOScreenState extends State<AdminCreateTOScreen>
    with SingleTickerProviderStateMixin {
  
  late TabController _tabController;
  
  // 단기용
  List<DateTime> _selectedDates = [];
  int _hourlyWage = 10030;
  
  // 1개월+용
  DateTime? _startDate;
  DateTime? _endDate;
  List<String> _workDays = [];
  int _monthlySalary = 1745220;
  
  @override
  void initState() {
    super.initState();
    _tabController = TabController(length: 2, vsync: this);
  }
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('TO 등록'),
        bottom: TabBar(
          controller: _tabController,
          tabs: [
            Tab(text: '단기 (1~30일)'),
            Tab(text: '1개월 이상'),
          ],
        ),
      ),
      body: TabBarView(
        controller: _tabController,
        children: [
          _buildShortTermTab(),
          _buildLongTermTab(),
        ],
      ),
    );
  }
  
  Widget _buildShortTermTab() {
    return SingleChildScrollView(
      padding: EdgeInsets.all(16),
      child: Column(
        children: [
          // 사업장 선택
          _buildBusinessSelector(),
          
          // 제목
          _buildTitleField(),
          
          // 캘린더 날짜 선택
          _buildCalendarSelector(),
          
          // 시급 입력 + 검증
          _buildHourlyWageField(),
          
          // 예상 급여 계산
          ExpectedPayWidget(
            hourlyWage: _hourlyWage,
            dailyHours: 8,
            workDays: _selectedDates.length,
          ),
          
          // 근무 시간
          _buildWorkTimeFields(),
          
          // 급여 지급
          _buildPaymentTimingField(),
          
          // 등록 버튼
          _buildSubmitButton(),
        ],
      ),
    );
  }
  
  Widget _buildLongTermTab() {
    // 1개월+ 폼
  }
}
```

---

### 7.2 캘린더 날짜 선택 위젯

```dart
class CalendarDateSelector extends StatefulWidget {
  final List<DateTime> selectedDates;
  final Function(List<DateTime>) onDatesSelected;
  
  @override
  State<CalendarDateSelector> createState() => _CalendarDateSelectorState();
}

class _CalendarDateSelectorState extends State<CalendarDateSelector> {
  late DateTime _focusedDay;
  
  @override
  void initState() {
    super.initState();
    _focusedDay = DateTime.now();
  }
  
  @override
  Widget build(BuildContext context) {
    return TableCalendar(
      firstDay: DateTime.now(),
      lastDay: DateTime.now().add(Duration(days: 90)),
      focusedDay: _focusedDay,
      
      // 복수 선택 모드
      selectedDayPredicate: (day) {
        return widget.selectedDates.any((selectedDay) =>
          isSameDay(selectedDay, day)
        );
      },
      
      onDaySelected: (selectedDay, focusedDay) {
        setState(() {
          _focusedDay = focusedDay;
          
          final dates = List<DateTime>.from(widget.selectedDates);
          
          if (dates.any((d) => isSameDay(d, selectedDay))) {
            // 이미 선택됨 → 제거
            dates.removeWhere((d) => isSameDay(d, selectedDay));
          } else {
            // 새로 선택
            if (dates.length < 30) {  // 최대 30일
              dates.add(selectedDay);
            } else {
              ScaffoldMessenger.of(context).showSnackBar(
                SnackBar(content: Text('최대 30일까지만 선택 가능합니다')),
              );
            }
          }
          
          widget.onDatesSelected(dates);
        });
      },
      
      // 스타일
      calendarStyle: CalendarStyle(
        selectedDecoration: BoxDecoration(
          color: Colors.blue,
          shape: BoxShape.circle,
        ),
        todayDecoration: BoxDecoration(
          color: Colors.blue.withOpacity(0.3),
          shape: BoxShape.circle,
        ),
      ),
    );
  }
}
```

---

### 7.3 지원자 - 공고 목록

#### 카드 스타일 구분
```dart
Widget _buildTOCard(TOModel to) {
  final isShortTerm = to.jobType == 'short';
  
  return Container(
    decoration: BoxDecoration(
      border: Border.all(
        color: isShortTerm ? Colors.blue : Colors.green,
      ),
      gradient: LinearGradient(
        colors: isShortTerm 
            ? [Colors.blue[50]!, Colors.white]
            : [Colors.green[50]!, Colors.white],
      ),
    ),
    child: Column(
      children: [
        // 헤더
        Row(
          children: [
            Icon(
              isShortTerm ? Icons.schedule : Icons.work,
              color: isShortTerm ? Colors.blue : Colors.green,
            ),
            Text(
              isShortTerm ? '단기 알바' : '1개월+ 계약직',
              style: TextStyle(
                color: isShortTerm ? Colors.blue : Colors.green,
              ),
            ),
            if (isShortTerm)
              Chip(label: Text('날짜 선택 가능'))
            else
              Chip(label: Text('전체 기간 필수')),
          ],
        ),
        
        // 제목, 사업장
        Text(to.title, style: TextStyle(fontWeight: FontWeight.bold)),
        Text(to.businessName),
        
        // 날짜/기간
        if (isShortTerm)
          Text('${to.selectedDates?.length ?? 0}일 선택 가능')
        else
          Text('${to.startDate} ~ ${to.endDate}'),
        
        // 급여
        if (isShortTerm)
          Text('시급 ${NumberFormat('#,###').format(to.hourlyWage)}원')
        else
          Text('월급 ${NumberFormat('#,###').format(to.monthlySalary)}원'),
        
        // 버튼
        ElevatedButton(
          onPressed: () => _applyToJob(to),
          child: Text('지원하기'),
        ),
      ],
    ),
  );
}
```

---

## 8. 구현 로드맵

### 🔴 Phase A: 탭 구조 + 단기 개선 (5~7일)

#### A-1. 탭 구조 구현 (1일)
- [ ] TabController 설정
- [ ] 2개 탭 UI (단기 / 1개월+)
- [ ] 탭별 폼 분리

#### A-2. 단기 - 캘린더 선택 (2일)
- [ ] table_calendar 패키지 추가
- [ ] 복수 날짜 선택 구현
- [ ] 최대 30일 제한
- [ ] 선택된 날짜 표시

#### A-3. 법정 급여 검증 (2일)
- [ ] LaborStandards 클래스 생성
- [ ] WageValidator 구현
- [ ] 최저시급 체크 UI
- [ ] 경고 메시지 표시

#### A-4. 주휴수당 계산 (2일)
- [ ] WeeklyHolidayPayCalculator 구현
- [ ] ExpectedPayWidget 생성
- [ ] 실시간 계산 표시
- [ ] 설명 메시지

---

### 🟡 Phase B: 1개월+ 구현 (4~5일)

#### B-1. 요일 선택 UI (1일)
- [ ] 요일 체크박스
- [ ] 주 근무시간 계산
- [ ] 선택된 요일 표시

#### B-2. 월급 검증 (2일)
- [ ] MonthlySalaryValidator 구현
- [ ] 시급 환산 계산
- [ ] MonthlySalaryInfoWidget 생성
- [ ] 검증 메시지 표시

#### B-3. 복리후생 입력 (1일)
- [ ] 4대보험 체크
- [ ] 기타 복리후생 입력
- [ ] 복리후생 표시

#### B-4. 데이터 저장 (1일)
- [ ] Firestore 저장 로직
- [ ] jobType 분기 처리
- [ ] 필드별 검증

---

### 🟢 Phase C: 목록/상세 (3~4일)

#### C-1. 목록 화면 개선 (2일)
- [ ] jobType별 카드 스타일
- [ ] 시각적 구분 (색상, 아이콘)
- [ ] 뱃지 표시
- [ ] TO 카드에 업무 표시

#### C-2. 상세 화면 (2일)
- [ ] 단기 상세 (날짜 선택)
- [ ] 1개월+ 상세
- [ ] 지원 프로세스

---

### 📊 전체 타임라인

```
Week 1: Phase A (탭 구조 + 단기)     5~7일
Week 2: Phase B (1개월+ 구현)       4~5일
Week 3: Phase C (목록/상세)         3~4일

총 예상 기간: 12~16일 (약 2.5~3주)
```

---

## 9. 코드 스니펫

### 9.1 통화 포맷터

```dart
class CurrencyInputFormatter extends TextInputFormatter {
  @override
  TextEditingValue formatEditUpdate(
    TextEditingValue oldValue,
    TextEditingValue newValue,
  ) {
    if (newValue.text.isEmpty) return newValue;
    
    // 숫자만 추출
    final number = int.tryParse(newValue.text.replaceAll(RegExp(r'[^0-9]'), ''));
    if (number == null) return oldValue;
    
    // 천단위 콤마
    final formatted = NumberFormat('#,###').format(number);
    
    return TextEditingValue(
      text: formatted,
      selection: TextSelection.collapsed(offset: formatted.length),
    );
  }
}

// 사용
TextFormField(
  keyboardType: TextInputType.number,
  inputFormatters: [
    FilteringTextInputFormatter.digitsOnly,
    CurrencyInputFormatter(),
  ],
  decoration: InputDecoration(
    suffix: Text('원'),
  ),
)
```

---

### 9.2 날짜 유틸리티

```dart
class DateUtils {
  /// 같은 날짜인지 비교
  static bool isSameDay(DateTime a, DateTime b) {
    return a.year == b.year &&
           a.month == b.month &&
           a.day == b.day;
  }
  
  /// 날짜 목록 정렬
  static List<DateTime> sortDates(List<DateTime> dates) {
    final sorted = List<DateTime>.from(dates);
    sorted.sort((a, b) => a.compareTo(b));
    return sorted;
  }
  
  /// 연속 날짜인지 확인
  static bool isConsecutive(List<DateTime> dates) {
    if (dates.length <= 1) return true;
    
    final sorted = sortDates(dates);
    
    for (int i = 0; i < sorted.length - 1; i++) {
      final diff = sorted[i + 1].difference(sorted[i]).inDays;
      if (diff != 1) return false;
    }
    
    return true;
  }
  
  /// 날짜 범위 텍스트
  static String formatDateRange(List<DateTime> dates) {
    if (dates.isEmpty) return '';
    
    final sorted = sortDates(dates);
    final first = sorted.first;
    final last = sorted.last;
    
    if (dates.length == 1) {
      return '${first.month}/${first.day}';
    }
    
    if (isConsecutive(dates)) {
      return '${first.month}/${first.day}~${last.month}/${last.day}';
    }
    
    return '${dates.length}일 (비연속)';
  }
}
```

---

### 9.3 요일 선택 위젯

```dart
class WorkDaySelector extends StatefulWidget {
  final List<String> selectedDays;
  final Function(List<String>) onDaysSelected;
  
  @override
  State<WorkDaySelector> createState() => _WorkDaySelectorState();
}

class _WorkDaySelectorState extends State<WorkDaySelector> {
  final List<String> _allDays = ['월', '화', '수', '목', '금', '토', '일'];
  
  @override
  Widget build(BuildContext context) {
    return Wrap(
      spacing: 8,
      children: _allDays.map((day) {
        final isSelected = widget.selectedDays.contains(day);
        
        return FilterChip(
          label: Text(day),
          selected: isSelected,
          onSelected: (selected) {
            final days = List<String>.from(widget.selectedDays);
            
            if (selected) {
              days.add(day);
            } else {
              days.remove(day);
            }
            
            widget.onDaysSelected(days);
          },
          selectedColor: Colors.blue[100],
          checkmarkColor: Colors.blue[700],
        );
      }).toList(),
    );
  }
}
```

---

## 10. 필요 패키지

### pubspec.yaml

```yaml
dependencies:
  flutter:
    sdk: flutter
  
  # Firebase
  firebase_core: ^2.24.0
  cloud_firestore: ^4.13.0
  firebase_auth: ^4.15.0
  
  # UI
  table_calendar: ^3.0.9      # ✅ 캘린더
  intl: ^0.18.0               # 통화/날짜 포맷
  
  # 기타
  provider: ^6.1.0
```

---

## 11. 체크리스트

### ✅ 완료 (Phase 1)
- [x] TO 모델 그룹화
- [x] 날짜 범위 TO 생성
- [x] 실시간 검증 (30일, 마감시간)
- [x] TO 목록 그룹 표시
- [x] FirestoreService 그룹 메서드

### 🔴 진행 예정 (Phase A)
- [ ] TabController 구현
- [ ] 단기/1개월+ 탭 UI
- [ ] 캘린더 날짜 선택
- [ ] 최저시급 검증
- [ ] 주휴수당 계산
- [ ] 예상 급여 위젯

### 🟡 대기 (Phase B)
- [ ] 요일 선택 UI
- [ ] 월급 검증
- [ ] 복리후생 입력
- [ ] 1개월+ 데이터 저장

### 🟢 계획 (Phase C)
- [ ] jobType별 카드 스타일
- [ ] 상세 화면
- [ ] 지원 프로세스

---

## 12. 주요 의사결정

### ✅ 확정된 결정

1. **채용 유형**: 단기 + 1개월+ (정직원 제외)
2. **탭 구조**: 2개 탭으로 명확히 구분
3. **단기 날짜**: 캘린더 복수 선택 (최대 30일)
4. **1개월+ 요일**: 체크박스 선택 방식
5. **법정 급여**: 최저시급 검증 + 주휴수당 자동 계산
6. **컬렉션**: 통합 (tos) - jobType으로 구분

### 🤔 검토 필요

1. **근태 관리**: 1개월+에서 어느 수준까지?
2. **복리후생**: 어떤 항목들?
3. **급여 정산**: 자동화 범위?

---

## 13. 참고 자료

### 벤치마킹
- **당근마켓 구인공고**: 탭 구조, 법정 급여 안내
- **알바몬**: 급여 계산기, 주휴수당 설명
- **사람인**: 채용 유형 분류

### 법률 참고
- 최저임금법
- 근로기준법 (주휴수당)
- 4대보험 기준

---

**작성일**: 2025-10-27  
**최종 수정**: 2025-10-27  
**작성자**: 개발팀  
**문서 버전**: v5.0 (최종 확정본)

---

## 📝 변경 이력

| 버전 | 날짜 | 내용 |
|------|------|------|
| v1.0 | 2025-10-24 | 초안 - 그룹화 기능 |
| v2.0 | 2025-10-24 | Phase 1 완료 |
| v3.0 | 2025-10-24 | 중간 보고서 통합 |
| v4.0 | 2025-10-27 | 급여/장기채용 논의 |
| v5.0 | 2025-10-27 | 탭 구조 + 법정 급여 확정 ✨ |
